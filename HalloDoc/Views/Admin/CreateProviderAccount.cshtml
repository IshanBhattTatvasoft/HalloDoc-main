@model EditProviderAccountViewModel

@{
    ViewData["Title"] = "Create Provider Account";
    <partial name="_ValidationScriptsPartial" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
}

<style>
    .accordion-button::after {
        display: none; /* Hide the default arrow */
    }

    #Signature::-webkit-file-upload-button {
        display: none;
    }

    #Photo::-webkit-file-upload-button {
        display: none;
    }

    #contract::-webkit-file-upload-button {
        display: none;
        visibility: hidden;
    }

    #backdesign {
        border-radius: 5px;
        border: 2px solid #84D3E6;
        padding: 8px;
        min-width: 80px;
    }

    hr {
        margin-top: 1rem;
        margin-bottom: 1rem;
        border: 0;
        border-top: 1px solid rgba(0, 0, 0);
    }

    input:focus {
        outline: #3DB6FF !important;
        /*border: 2px solid white !important;*/
        box-shadow: none !important;
        border-color: #3DB6FF !important;
        /*color: red !important;*/
    }

    textarea:focus {
        outline: none !important;
        border-color: #3DB6FF !important;
        box-shadow: none !important;
    }


    .form-floating:focus-within label {
        color: #3DB6FF !important;
    }

    select:focus{
        outline: #3DB6FF !important;
        /*border: 2px solid white !important;*/
        box-shadow: none !important;
        border-color: #3DB6FF !important;
        /*color: red !important;*/
    }

</style>

<body class="bg-light">
    <div class="bg-light" style="overflow: hidden;">
        <partial name="Toast" />
        <partial name="HeaderFooter" model="@Model.adminNavbarModel" />

        <div class="container mt-4 shadowalign-content-lg-around bg-muted rounded">
            <div class="row d-flex flex-row">
                <div class="w-50">
                    <p class="h5 text-muted fw-bold ms-0" id="heading-one">
                        Create Provider Account
                    </p>
                </div>
                <div class="w-50">
                    <a class="float-end text-info" id="backdesign" asp-controller="Admin" asp-action="AdminDashboard" style="text-decoration: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0" />
                        </svg>
                        Back
                    </a>
                </div>
            </div>
        </div>

        <div class="container mt-2 shadow-lg p-3 mb-5 bg-muted rounded" id="main-container">
            <div class="row">
                <div class="col mt-4">
                    <p class="h5 text-muted fw-bold ms-1" id="heading-one">
                        Account Information
                    </p>
                </div>
            </div>

            <form method="post" asp-action="CreateNewProviderAccount" asp-controller="Admin" enctype="multipart/form-data">
                <div class="row mt-3">
                    <div class="form-floating col-sm-4">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="UserName" disabled>
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Username (MD.LastName.F)</label>
                        <span asp-validation-for="UserName" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-4">
                        <input class="form-control" type="password" asp-for="Password" required />
                        <span asp-validation-for="Password" class="text-danger"></span>
                    </div>
                    <div class="col-md-4 mb-3 form-floating">
                        <select class="form-select mb-3 update1" id="Role" asp-for="roleId">
                            @foreach (var item in Model.allRoles)
                            {
                                if (item.AccountType == 2)
                                {
                                    <option value="@item.RoleId">@item.Name</option>
                                }
                            }
                        </select>
                        <label for="Role" class="ms-2 text-muted">Role</label>
                        <span asp-validation-for="roleId" class="text-danger"></span>
                    </div>
                </div>



                <div class="row">
                    <div class="col mt-4">
                        <p class="h5 text-muted fw-bold ms-1" id="heading-one">
                            Administrator Information
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="FirstName">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">First Name</label>
                        <span asp-validation-for="FirstName" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="LastName">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Last Name</label>
                        <span asp-validation-for="LastName" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="Email">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Email</label>
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-6 mt-3">
                        <input id="phone" class="form-control" type="tel" asp-for="Phone" required />
                        <span asp-validation-for="Phone" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="MedicalLicense">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Medical License #</label>
                        <span asp-validation-for="MedicalLicense" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="LastName">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">NPI Number</label>
                        <span asp-validation-for="NPI" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6 form-floating mt-3">
                        @foreach (var item in Model.regions)
                        {
                            <input class="region-check px-1" type="checkbox" name="regionNames" value="@item.RegionId" />
                            <span class="me-2">@item.Name</span>
                        }
                    </div>
                </div>

                <div class="row">
                    <div class="col mt-4">
                        <p class="h5 text-muted fw-bold ms-1" id="heading-one">
                            Mailing and Billing Information
                        </p>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" id="Address1" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="Address1">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Address 1</label>
                        <span asp-validation-for="Address1" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" id="Address2" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="Address2">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Address 2</label>
                        <span asp-validation-for="Address2" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" id="City" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="City">
                        <input type="hidden" id="lat" asp-for="lati" style="display: none;" />
                        <input type="hidden" id="long" asp-for="longi" style="display: none;" />
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">City</label>
                        <span asp-validation-for="City" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-6 mt-3">
                        <select class="mbi form-select" aria-label="Default select example" asp-for="regionId">
                            <option value="-1" class="bg-white" selected>Select Region</option>
                            @foreach (var item in Model.regions)
                            {
                                <option value="@item.RegionId" class="bg-white">@item.Name</option>
                            }
                        </select>
                        <span asp-validation-for="regionId" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="Zip">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Zip</label>
                        <span asp-validation-for="Zip" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-6 mt-3">
                        <input id="phone1" class="form-control" type="tel" asp-for="MailingPhoneNo" required />
                        <span asp-validation-for="MailingPhoneNo" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="col mt-4">
                        <p class="h5 text-muted fw-bold ms-1" id="heading-one">
                            Provider Profile
                        </p>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="BusinessName">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Business Name</label>
                        <span asp-validation-for="BusinessName" class="text-danger"></span>
                    </div>
                    <div class="form-floating col-sm-6 mt-3">
                        <input type="text" class="form-control" placeholder="Your First Name" aria-label="First name" asp-for="BusinessWebsite">
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Business Website</label>
                        <span asp-validation-for="BusinessWebsite" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col-sm-6 mt-3">
                        <div class="d-flex gap-0">
                            <input type="file" class="form-control rounded-end-0 change3" id="Photo" placeholder="Select Photo" asp-for="Photo" />
                            <button type="button" class="btn btn-info text-white rounded-start-0" onclick="SaveSign('1')">Upload</button>
                            <span asp-validation-for="Photo" class="text-danger"></span>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="form-floating col mt-3">
                        <textarea asp-for="AdminNotes" rows="4" style="min-height: calc(4em + 1.5rem);height: calc(4em + 1.5rem);resize: none;" placeholder="Admin Notes" class="form-control border border-info" id="exampleTextarea" rows="4"></textarea>
                        <label for="floatingInput" class="ms-2 text-muted class-for-label">Admin Notes</label>
                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="col mt-4">
                        <p class="h5 text-muted fw-bold ms-1" id="heading-one">
                            Onboarding
                        </p>
                    </div>
                </div>

                <div class="row">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <div class="form-check d-flex justify-content-between col-6">
                            <input type="checkbox" class="form-check-input border-2 region-check" value="@Model.Contract"
                                   id="Contract" name="checkbox_group" />
                            <p class="ms-1">Independent Contract Agreement</p>
                        </div>
                        <div class="d-flex justify-content-between col-4">
                            <input type="file" class="form-control btn btn-info text-white" id="contract" value="Upload" asp-for="ContractAgreementFile" hidden />
                            <label class="btn btn-info text-white" for="contract">Upload</label>
                            @if (Model.Contract == true)
                            {
                                <a class="btn btn-info text-white ms-2" href="~/Physician/@Model.PhysicianId/AgreementDoc.pdf" target="_blank">View</a>
                            }
                            <span asp-validation-for="ContractAgreementFile" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <div class="form-check d-flex justify-content-between col-6">
                            <input type="checkbox" class="form-check-input border-2 region-check" value="@Model.Contract"
                                   id="Background" name="checkbox_group" />
                            <p>Background Check</p>
                        </div>
                        <div class="d-flex justify-content-between col-4">
                            <input type="file" class="form-control btn btn-info text-white" id="BackgroundCheck" value="Upload" asp-for="BackgroundCheckFile" hidden />
                            <label class="btn btn-info text-white" for="BackgroundCheck">Upload</label>
                            <div>
                                @if (Model.BackgroundCheck == true)
                                {
                                    <a class="btn btn-info text-white ms-2" href="~/Physician/@Model.PhysicianId/BackgroundDoc.pdf" target="_blank">View</a>
                                }
                                <span asp-validation-for="BackgroundCheckFile" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <div class="form-check d-flex justify-content-between col-6">
                            <input type="checkbox" class="form-check-input border-2 region-check" value="@Model.Contract"
                                   id="Compliance" name="checkbox_group" />
                            <p>HIPAA Compliance</p>
                        </div>
                        <div class="d-flex justify-content-between col-4">
                            <input type="file" class="form-control btn btn-info text-white" id="Compilance" value="Upload" asp-for="HippaFile" hidden />
                            <label class="btn btn-info text-white" for="Compilance">Upload</label>
                            @if (Model.Compilance == true)
                            {
                                <a class="btn btn-info text-white ms-2" href="~/Physician/@Model.PhysicianId/Compilance.pdf">View</a>
                            }
                            <span asp-validation-for="HippaFile" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <div class="form-check d-flex justify-content-between col-6">
                            <input type="checkbox" class="form-check-input border-2 region-check" value="@Model.Contract"
                                   id="NonDisclosure" name="checkbox_group" />
                            <p>Non-disclosure Agreement</p>
                        </div>
                        <div class="d-flex justify-content-between col-4">
                            <input type="file" class="form-control btn btn-info text-white" id="NonDisclosure" value="Upload" asp-for="NonDisclosureAgreement" hidden />
                            <label class="btn btn-info text-white" for="NonDisclosure">Upload</label>
                            @if (Model.NonDisclosure == true)
                            {
                                <button class="btn btn-info text-white ms-2" href="~/Physician/@Model.PhysicianId/NonDisclosure.pdf">View</button>
                            }
                            <span asp-validation-for="NonDisclosureAgreement" class="text-danger"></span>
                        </div>
                    </div>

                    <hr />

                    <div class="form-floating col mt-4 lastbutton float-end" id="submitDivv">
                        <button type="submit" class="btn btn-success float-end me-3">Create Account</button>
                    </div>
                </div>


            </form>
        </div>

    </div>


</body>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARrk6kY-nnnSpReeWotnQxCAo_MoI4qbU&callback=initMap"></script>

<script>
    const phoneInputField = document.querySelector("#phone");
    const phoneInput = window.intlTelInput(phoneInputField, {
        innerHeight: 1,
        utilsScript:
            "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
    });

    const phoneInputField1 = document.querySelector("#phone1");
    const phoneInput1 = window.intlTelInput(phoneInputField1, {
        innerHeight: 1,
        utilsScript:
            "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
    });

    function getRoleVal() {
        console.log("Hello");
        document.getElementById("hiddenRole").value = document.getElementById("getRoles").value;
    }

    document.getElementById('City').addEventListener('focusout', getCoordinates);
    function getCoordinates() {
        var address = document.getElementById('Address1').value + " " + document.getElementById('Address2').value + " " + document.getElementById('City').value;
        var geocoder = new google.maps.Geocoder();
        geocoder.geocode({ address: address }, function (results, status) {
            if (status == "OK") {
                var latitude = results[0].geometry.location.lat();
                var longitude = results[0].geometry.location.lng();
                document.getElementById('lat').value = latitude;
                document.getElementById('long').value = longitude;
                console.log(document.getElementById('lat').value);
                console.log(document.getElementById('long').value);
                //return true;
            } else {
                console.log("Geocoding failed: " + status);
                //return false;
            }
        });
        //return true;
    }

    function UploadDoc(num) {
        var doc;
        var PhysicianId = document.getElementById('IdOfP').value;
        console.log(num);
        if (num == 1) doc = document.getElementById("contract");
        else if (num == 2) doc = document.getElementById("BackgroundCheck");
        else if (num == 3) doc = document.getElementById("Compilance");
        else if (num == 4) doc = document.getElementById("NonDisclosure");
        else doc = document.getElementById("LicensedDoc");
        var files = doc.files[0];
        if (!validateFileType(files)) {
            var formData = new FormData();
            // Append the selected file to the FormData object
            formData.append("file", files);
            formData.append("PhysicianId", PhysicianId);
            formData.append("num", num);
            $.ajax({
                type: "POST",
                url: "@Url.Action("SetAllDocOfPhysician", "Admin")",
                data: formData,
                processData: false,
                contentType: false,
                success: function (result) {
                    // Handle success
                    console.log("Done");
                    window.location.href = `EditPhysicianAccount?id=${PhysicianId}`;
                },
                error: function (error) {
                    // Handle error
                    console.error(error);
                }
            });
        }
    }
</script>
